<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>South Valley QG</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Archivo+Black&family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --accent: #f59e0b;
            --accent-dim: rgba(245, 158, 11, 0.1);
            --bg: #000000;
            --card: #0a0a0a;
            --border: #1a1a1a;
            --text-main: #ffffff;
            --text-dim: #888888;
        }

        * { -webkit-tap-highlight-color: transparent; outline: none; box-sizing: border-box; }
        body { 
            background-color: var(--bg); 
            color: var(--text-main); 
            font-family: 'Inter', sans-serif; 
            margin: 0; padding: 0; 
            overflow: hidden; 
            height: 100vh;
        }

        .brand-font { font-family: 'Archivo Black', sans-serif; }
        .pb-safe { padding-bottom: env(safe-area-inset-bottom); }
        
        .nav-glass {
            background: rgba(10, 10, 10, 0.8);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-top: 1px solid var(--border);
        }

        .titanium-card {
            background: linear-gradient(145deg, #0f0f0f, #050505);
            border: 1px solid var(--border);
            border-radius: 16px;
        }

        /* Ticker */
        .ticker-wrap {
            width: 100%; overflow: hidden; height: 24px;
            background: #050505; border-bottom: 1px solid #111;
            display: flex; align-items: center;
        }
        .ticker-move {
            display: flex; white-space: nowrap;
            animation: tickerMove 40s linear infinite;
        }
        @keyframes tickerMove { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }
        .ticker-item { display: inline-flex; align-items: center; padding: 0 20px; font-size: 9px; font-weight: 900; color: #555; }

        /* Intro layer */
        #intro-layer {
            position: fixed; inset: 0; z-index: 999;
            background: #000; display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            transition: opacity 0.8s ease;
        }

        .logo-container {
            position: relative; width: 140px; height: 140px;
            display: flex; justify-content: center; align-items: center;
        }
        .logo-sequence {
            position: absolute; width: 100%; height: 100%;
            border: 2px solid var(--accent); border-radius: 50%;
            animation: ringPulse 2s infinite ease-in-out;
        }
        @keyframes ringPulse { 0% { transform: scale(0.8); opacity: 0; } 50% { opacity: 0.5; } 100% { transform: scale(1.2); opacity: 0; } }

        .fade-in { animation: fadeIn 0.4s ease-out forwards; opacity: 0; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .btn-main {
            background: var(--accent); color: #000;
            border-radius: 12px; font-weight: 900;
            transition: all 0.2s;
            text-transform: uppercase;
        }
        .btn-main:active { transform: scale(0.95); }
        
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body>

<div id="intro-layer">
    <div class="logo-container">
        <div class="logo-sequence"></div>
        <div class="text-center z-10">
            <h1 class="text-4xl font-black text-white brand-font tracking-tighter">S<span class="text-[--accent]">V</span></h1>
            <p class="text-[8px] tracking-[0.3em] font-bold text-gray-500 mt-2">SECURE GATEWAY</p>
        </div>
    </div>
</div>

<div id="app-container" class="hidden h-screen flex flex-col max-w-md mx-auto relative bg-black">
    
    <div class="ticker-wrap shrink-0">
        <div class="ticker-move" id="live-ticker"></div>
    </div>

    <header class="px-4 py-4 flex justify-between items-center border-bottom border-[#111] shrink-0 bg-black/50 backdrop-blur-md">
        <div class="flex items-center gap-2">
            <div class="w-2 h-2 rounded-full bg-[--accent] shadow-[0_0_8px_var(--accent)]"></div>
            <h1 class="text-xs font-black text-white uppercase tracking-wider brand-font">South Valley QG</h1>
        </div>
        <div class="flex items-center gap-1.5 bg-[#111] px-3 py-1.5 rounded-full border border-white/5">
            <div id="status-dot" class="w-1.5 h-1.5 rounded-full bg-green-500"></div>
            <span id="status-text" class="text-[8px] font-bold text-gray-400 uppercase tracking-widest">Op√©rationnel</span>
        </div>
    </header>

    <main id="main-view" class="flex-1 overflow-y-auto px-4 py-6 space-y-6 no-scrollbar"></main>

    <nav class="nav-glass fixed bottom-0 w-full h-16 pb-safe z-50 flex justify-around items-center px-2">
        <button onclick="router('menu')" id="nav-menu" class="flex flex-col items-center justify-center w-16 transition-all">
            <span class="text-xl">üè†</span>
            <span class="text-[9px] font-bold uppercase tracking-wide">Accueil</span>
        </button>
        <button onclick="router('products')" id="nav-products" class="flex flex-col items-center justify-center w-16 opacity-50 transition-all">
            <span class="text-xl">üåø</span>
            <span class="text-[9px] font-bold uppercase tracking-wide">Menu</span>
        </button>
        <button onclick="router('cart')" id="nav-cart" class="relative flex flex-col items-center justify-center w-16 opacity-50 transition-all">
            <span class="text-xl">üõí</span>
            <span class="text-[9px] font-bold uppercase tracking-wide">Panier</span>
            <div id="cart-count" class="absolute -top-1 right-2 bg-[--accent] text-black text-[9px] font-black w-4 h-4 rounded-full flex items-center justify-center hidden">0</div>
        </button>
        <button onclick="router('infos')" id="nav-infos" class="flex flex-col items-center justify-center w-16 opacity-50 transition-all">
            <span class="text-xl">üì¶</span>
            <span class="text-[9px] font-bold uppercase tracking-wide">Infos</span>
        </button>
    </nav>

    <!-- Product Modal -->
    <div id="product-modal" class="fixed inset-0 z-[60] bg-black/90 hidden flex items-end sm:items-center justify-center backdrop-blur-sm">
        <div id="modal-content" class="bg-[#111] w-full max-w-sm h-[85vh] sm:rounded-2xl rounded-t-3xl border-t border-[--border] shadow-2xl flex flex-col transform translate-y-full transition-transform duration-300">
            <div class="relative w-full h-56 bg-black shrink-0 sm:rounded-t-2xl overflow-hidden">
                <img id="modal-image" class="w-full h-full object-cover" src="" alt="Product">
                <div class="absolute inset-0 bg-gradient-to-t from-[#111] to-transparent"></div>
                <button onclick="closeModal()" class="absolute top-4 right-4 bg-black/50 text-white w-8 h-8 rounded-full flex items-center justify-center backdrop-blur-md z-10">‚úï</button>
            </div>
            <div class="p-6 flex-1 overflow-y-auto no-scrollbar">
                <h2 id="modal-title" class="text-xl font-black text-white uppercase brand-font mb-1"></h2>
                <span id="modal-tag" class="text-[9px] font-bold bg-[--accent-dim] text-[--accent] px-2 py-1 rounded uppercase border border-[--accent]/20 inline-block mb-3"></span>
                <p id="modal-desc" class="text-xs text-gray-400 mb-6 leading-relaxed whitespace-pre-line"></p>
                <div id="tiers-list" class="space-y-2"></div>
            </div>
        </div>
    </div>
</div>

<script>
    const CONFIG = { 
        ADMIN: "33759840764", 
        CURRENCY: "‚Ç¨"
    };

    let cart = [];

    const CATALOG = [
        {
            id: 'WZ-ALL', name: "Wizard Treez üßä", category: "Sunny Valley", tag: "FROZEN SIFT",
            desc: "IMPORT CALI EXCLUSIF.\n\n5 Strains: Honey Banana, Dream Queen, Forbidden Fruits, Apple Gelato, OG Donutz.",
            images: ["https://res.cloudinary.com/dlmmylat6/image/upload/v1765993841/IMG_2073_ffmyfd.jpg"],
            tiers: [{w:'5G',p:80},{w:'10G',p:170}]
        },
        {
            id: 'PK', name: "Pink Kush üß¨", category: "Sunny Valley", tag: "TOP SHELF",
            desc: "Taux THC 34%. Terp√®nes explosifs. La r√©f√©rence Top Shelf.",
            images: ["https://res.cloudinary.com/dlmmylat6/image/upload/v1765993841/IMG_2073_ffmyfd.jpg"],
            tiers: [{w:'5G',p:60},{w:'10G',p:120}]
        },
        {
            id: 'MC', name: "Monte Cristo üèîÔ∏è", category: "Snow Valley", tag: "DIAMOND",
            desc: "Origine Bolivie üáßüá¥. Puret√© exceptionnelle (0.98%).",
            images: ["https://res.cloudinary.com/dlmmylat6/image/upload/v1765993841/IMG_2073_ffmyfd.jpg"],
            tiers: [{w:'1G',p:60},{w:'2G',p:120}]
        }
    ];

    window.onload = () => {
        // Animation d'intro forc√©e m√™me hors Telegram
        updateTicker();
        setTimeout(() => {
            document.getElementById('intro-layer').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('intro-layer').style.display = 'none';
                document.getElementById('app-container').classList.remove('hidden');
                router('menu');
            }, 800);
        }, 1500);
    };

    function router(view, data) {
        const main = document.getElementById('main-view');
        document.querySelectorAll('nav button').forEach(b => b.classList.add('opacity-50'));
        document.getElementById(`nav-${view === 'products' ? 'products' : view}`)?.classList.remove('opacity-50');
        
        main.innerHTML = '';
        if(view === 'menu') renderMenu(main);
        else if(view === 'products') renderProducts(main, data);
        else if(view === 'cart') renderCart(main);
        else if(view === 'infos') renderInfos(main);
    }

    function renderMenu(c) {
        c.innerHTML = `
            <div class="titanium-card p-6 mb-4 fade-in text-center border-t-2 border-[--accent]" onclick="router('products', 'Sunny Valley')">
                <h2 class="text-3xl font-black brand-font text-white mb-2 uppercase">Sunny Valley</h2>
                <p class="text-[10px] text-gray-500 uppercase tracking-[0.3em]">Cali Connect ‚Ä¢ Top Shelf</p>
            </div>
            <div class="titanium-card p-6 mb-4 fade-in text-center border-t-2 border-blue-500" onclick="router('products', 'Snow Valley')">
                <h2 class="text-3xl font-black brand-font text-white mb-2 uppercase">Snow Valley</h2>
                <p class="text-[10px] text-gray-500 uppercase tracking-[0.3em]">Diamond Purity ‚Ä¢ 0.98%</p>
            </div>
        `;
    }

    function renderProducts(c, catName) {
        const items = CATALOG.filter(p => !catName || p.category === catName);
        items.forEach(p => {
            const card = document.createElement('div');
            card.className = "titanium-card overflow-hidden flex flex-col fade-in cursor-pointer active:scale-[0.98] transition-transform";
            card.onclick = () => openProduct(p.id);
            card.innerHTML = `
                <div class="h-32 bg-zinc-900 relative">
                    <img src="${p.images[0]}" class="w-full h-full object-cover opacity-60">
                    <div class="absolute inset-0 bg-gradient-to-t from-black to-transparent"></div>
                    <span class="absolute bottom-2 left-3 text-[8px] font-black bg-[--accent] text-black px-2 py-0.5 rounded">${p.tag}</span>
                </div>
                <div class="p-3">
                    <div class="flex justify-between items-center">
                        <h3 class="font-bold text-sm text-white uppercase">${p.name}</h3>
                        <span class="text-xs">√†pd ${p.tiers[0].p}‚Ç¨</span>
                    </div>
                </div>
            `;
            c.appendChild(card);
        });
    }

    function openProduct(id) {
        const p = CATALOG.find(x => x.id === id);
        document.getElementById('modal-title').innerText = p.name;
        document.getElementById('modal-desc').innerText = p.desc;
        document.getElementById('modal-tag').innerText = p.tag;
        document.getElementById('modal-image').src = p.images[0];

        const tiersList = document.getElementById('tiers-list');
        tiersList.innerHTML = p.tiers.map(t => `
            <div onclick="addToCart('${p.id}', '${t.w}', ${t.p})" class="flex justify-between items-center p-4 bg-black/40 border border-[#222] rounded-xl active:bg-[--accent]/20">
                <span class="font-bold text-white">${t.w}</span>
                <span class="font-black text-[--accent]">${t.p}‚Ç¨</span>
            </div>
        `).join('');

        document.getElementById('product-modal').classList.remove('hidden');
        setTimeout(() => document.getElementById('modal-content').style.transform = 'translateY(0)', 10);
    }

    function addToCart(id, weight, price) {
        const p = CATALOG.find(x => x.id === id);
        cart.push({ name: p.name, weight, price });
        updateCartCount();
        closeModal();
    }

    function updateCartCount() {
        const el = document.getElementById('cart-count');
        el.innerText = cart.length;
        el.classList.toggle('hidden', cart.length === 0);
    }

    function closeModal() {
        document.getElementById('modal-content').style.transform = 'translateY(100%)';
        setTimeout(() => document.getElementById('product-modal').classList.add('hidden'), 300);
    }

    function renderCart(c) {
        if(cart.length === 0) {
            c.innerHTML = `<div class="text-center py-20 text-gray-500"><p>Panier vide.</p></div>`;
            return;
        }
        let total = cart.reduce((s, i) => s + i.price, 0);
        c.innerHTML = `
            <h2 class="text-2xl font-black text-white brand-font uppercase mb-6">Panier</h2>
            <div class="space-y-3 mb-6">
                ${cart.map((item, idx) => `
                    <div class="titanium-card p-4 flex justify-between items-center">
                        <div>
                            <p class="font-bold text-sm text-white">${item.name}</p>
                            <p class="text-[10px] text-gray-500">${item.weight}</p>
                        </div>
                        <div class="flex items-center gap-4">
                            <span class="font-bold text-[--accent]">${item.price}‚Ç¨</span>
                            <button onclick="removeFromCart(${idx})" class="text-red-500">‚úï</button>
                        </div>
                    </div>
                `).join('')}
            </div>
            <button onclick="checkout()" class="btn-main w-full py-4 text-sm tracking-widest">VALIDER (${total}‚Ç¨)</button>
        `;
    }

    function removeFromCart(idx) {
        cart.splice(idx, 1);
        renderCart(document.getElementById('main-view'));
        updateCartCount();
    }

    function checkout() {
        let text = "Commande South Valley :\n\n";
        cart.forEach(i => text += `‚Ä¢ ${i.name} | ${i.weight} | ${i.price}‚Ç¨\n`);
        text += `\nTOTAL : ${cart.reduce((s, x) => s + x.price, 0)}‚Ç¨`;
        window.open(`https://wa.me/${CONFIG.ADMIN}?text=${encodeURIComponent(text)}`);
    }

    function renderInfos(c) {
        c.innerHTML = `
            <h2 class="text-2xl font-black text-white brand-font mb-6 uppercase">Support</h2>
            <a href="https://wa.me/${CONFIG.ADMIN}" class="titanium-card p-6 flex flex-col items-center gap-2 border-green-500/30 mb-4">
                <span class="text-2xl">üí¨</span>
                <span class="text-[10px] font-black uppercase text-green-400">WhatsApp Support</span>
            </a>
        `;
    }

    function updateTicker() {
        const el = document.getElementById('live-ticker');
        const msg = '<span class="ticker-item">LIVRAISON EXPRESS ‚ö°</span><span class="ticker-item">SECURE PAYMENT üîí</span>';
        el.innerHTML = msg.repeat(10);
    }
</script>

</body>
</html>
