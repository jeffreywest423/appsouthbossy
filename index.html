<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <title>Service Gateway</title> 
    <meta name="description" content="Error 404">
    <meta name="robots" content="noindex, nofollow, noochive">

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Montserrat:wght@600;700;800;900&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <style>
        /* --- IDENTITY --- */
        :root {
            --bg-deep: #050505;
            --bg-card: #111111;
            --accent: #F59E0B;
            --accent-dim: rgba(245, 158, 11, 0.15);
            --text-main: #FFFFFF;
            --text-muted: #9CA3AF;
            --border: #222222;
        }

        body {
            background-color: var(--bg-deep);
            color: var(--text-main);
            font-family: 'Inter', sans-serif;
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
        }

        h1, h2, h3, .brand-font { font-family: 'Montserrat', sans-serif; letter-spacing: -0.02em; }
        .mono-font { font-family: 'JetBrains Mono', monospace; }

        /* --- UI COMPONENTS --- */
        .titanium-card {
            background: linear-gradient(145deg, #151515, #0a0a0a);
            border: 1px solid var(--border);
            border-radius: 16px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.5);
        }
        
        .nav-glass {
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(12px);
            border-top: 1px solid var(--border);
        }

        .btn-main {
            background: linear-gradient(to right, #F59E0B, #D97706);
            color: black;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            box-shadow: 0 0 15px rgba(245, 158, 11, 0.3);
            border-radius: 10px;
            transition: transform 0.1s;
        }
        .btn-main:active { transform: scale(0.98); }

        .btn-upsell {
            background: linear-gradient(to right, #ec4899, #8b5cf6);
            color: white;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            box-shadow: 0 0 15px rgba(236, 72, 153, 0.4);
            border-radius: 10px;
        }

        /* --- MARKET TICKER --- */
        .marquee-container {
            overflow: hidden;
            white-space: nowrap;
            background: #080808;
            border-bottom: 1px solid #222;
            padding: 8px 0;
            position: relative;
        }
        .marquee-content {
            display: inline-block;
            animation: marquee 30s linear infinite;
            font-family: 'JetBrains Mono', monospace;
            font-size: 10px;
            color: #ccc;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .ticker-item { margin-right: 40px; display: inline-flex; align-items: center; gap: 8px; }
        .ticker-icon { color: var(--accent); }
        .ticker-val { color: #fff; font-weight: bold; }
        .ticker-down { color: #ef4444; }
        .ticker-up { color: #10b981; }

        @keyframes marquee { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }

        /* --- INTRO PRESTIGE --- */
        #intro-layer {
            position: fixed; inset: 0; z-index: 100;
            background: black;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
        }
        .logo-container {
            position: relative; width: 140px; height: 140px;
            display: flex; justify-content: center; align-items: center;
        }
        .logo-img {
            width: 100px;
            filter: drop-shadow(0 0 15px rgba(245, 158, 11, 0.3));
        }

        .loading-line {
            width: 0; height: 2px;
            background: linear-gradient(90deg, transparent, var(--accent), transparent);
            margin-top: 40px;
            animation: lineExpand 2s ease-out forwards 0.5s;
        }
        .intro-text {
            margin-top: 16px; font-family: 'Montserrat', sans-serif;
            font-size: 10px; color: #666; letter-spacing: 0.3em;
            text-transform: uppercase; opacity: 0;
            animation: textFadeIn 1s ease-out forwards 1s;
        }

        @keyframes lineExpand { 0% { width: 0; opacity: 0; } 50% { opacity: 1; } 100% { width: 150px; opacity: 0; } }
        @keyframes textFadeIn { to { opacity: 1; } }

        /* --- ANIMATIONS --- */
        .fade-in { animation: fadeIn 0.4s ease-out forwards; opacity: 0; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        #confetti-canvas { position: fixed; inset: 0; pointer-events: none; z-index: 200; } 
        
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        select {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%239ca3af' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.5rem center;
            background-repeat: no-repeat;
            background-size: 1.5em 1.5em;
        }
    </style>
</head>
<body class="antialiased">

<div id="panic-screen" class="hidden fixed inset-0 z-[200] bg-black flex items-center justify-center"><h1 class="text-red-600 font-mono">CONNECTION LOST</h1></div>
<div id="maintenance-screen" class="hidden fixed inset-0 z-[150] bg-black flex items-center justify-center"><h1 class="text-xl font-bold text-red-600">SYSTEM OFFLINE</h1></div>

<div id="access-denied-screen" class="hidden fixed inset-0 z-[200] bg-black flex flex-col items-center justify-center text-center p-8">
    <div class="w-20 h-20 bg-red-900/20 rounded-full flex items-center justify-center mb-6 border border-red-900/50">
        <span class="text-4xl">üõ°Ô∏è</span>
    </div>
    <h1 class="text-2xl font-black brand-font text-red-600 mb-4 tracking-widest uppercase">ACC√àS REFUS√â</h1>
    <p class="text-xs text-gray-500 max-w-sm font-mono leading-relaxed">
        CONNEXION NON S√âCURIS√âE D√âTECT√âE.<br>
        CE PORTAIL EST ACCESSIBLE UNIQUEMENT VIA LE R√âSEAU TELEGRAM CHIFFR√â.
    </p>
</div>

<div id="intro-layer">
    <div class="logo-container">
        <img src="https://res.cloudinary.com/dlmmylat6/image/upload/v1765067656/Sans_titre_Logo_wjtljl.png" class="logo-img">
    </div>
    <div class="loading-line"></div>
    <p class="intro-text">Secure Access</p>
</div>

<div id="app-container" class="hidden flex flex-col h-screen pb-20 overflow-hidden">
    <div class="fixed inset-0 z-[-2]">
        <div class="absolute inset-0 bg-gradient-to-b from-black/80 via-black/90 to-black"></div>
        <div class="w-full h-full object-cover opacity-20 bg-[url('https://res.cloudinary.com/dlmmylat6/image/upload/v1765419450/Sans_titre_Bannie%CC%80re_moyenne_US_Paysage_1_gpbddu.png')] bg-cover bg-center"></div>
    </div>
    <canvas id="confetti-canvas"></canvas>

    <header class="bg-black/80 backdrop-blur-md z-40 shrink-0 border-b border-white/5">
        <div class="h-14 px-5 flex items-center justify-between">
            <div class="flex items-center gap-3" onclick="router('menu')">
                <img src="https://res.cloudinary.com/dlmmylat6/image/upload/v1765067656/Sans_titre_Logo_wjtljl.png" class="h-10 w-auto drop-shadow-[0_0_10px_rgba(245,158,11,0.5)]">
                <div>
                    <h1 class="text-xs font-black text-white uppercase tracking-wider brand-font">South Valley</h1>
                    <div class="flex items-center gap-1.5" id="shop-status">
                        <div id="status-dot" class="w-1.5 h-1.5 rounded-full bg-gray-500"></div>
                        <span id="status-text" class="text-[8px] font-bold text-gray-400 uppercase tracking-widest">Chargement...</span>
                    </div>
                </div>
            </div>
            <div class="text-xl opacity-80 animate-pulse text-[--accent]">‚ö°</div>
        </div>
        <div class="marquee-container">
            <div class="marquee-content" id="live-ticker">INITIALISATION FLUX MARCH√â...</div>
        </div>
    </header>

    <main id="main-view" class="flex-1 overflow-y-auto px-4 py-6 space-y-6 no-scrollbar"></main>

    <nav class="nav-glass fixed bottom-0 w-full h-16 pb-safe z-50 flex justify-around items-center px-2">
        <button onclick="router('menu')" id="nav-menu" class="flex flex-col items-center justify-center w-16 opacity-50 transition-all">
            <span class="text-xl mb-1">üè†</span>
            <span class="text-[9px] font-bold uppercase tracking-wide">QG</span>
        </button>
        <button onclick="router('products')" id="nav-products" class="flex flex-col items-center justify-center w-16 opacity-50 transition-all">
            <span class="text-xl mb-1">üìã</span>
            <span class="text-[9px] font-bold uppercase tracking-wide">Menu</span>
        </button>
        <button onclick="router('cart')" id="nav-cart" class="flex flex-col items-center justify-center w-16 opacity-50 transition-all relative">
            <div class="relative">
                <span class="text-xl mb-1">üõçÔ∏è</span>
                <span id="cart-dot" class="absolute -top-1 -right-1 w-2 h-2 bg-[--accent] rounded-full hidden"></span>
            </div>
            <span class="text-[9px] font-bold uppercase tracking-wide">Panier</span>
        </button>
        <button onclick="router('infos')" id="nav-infos" class="flex flex-col items-center justify-center w-16 opacity-50 transition-all">
            <span class="text-xl mb-1">üì°</span>
            <span class="text-[9px] font-bold uppercase tracking-wide">Infos</span>
        </button>
    </nav>

    <!-- MODALS (Full Logic Restored) -->
    <div id="product-modal" class="fixed inset-0 z-[60] bg-black/90 hidden flex items-end sm:items-center justify-center backdrop-blur-sm p-0 sm:p-4">
        <div id="modal-content" class="bg-[#111] w-full max-w-sm h-[85vh] sm:h-auto sm:max-h-[80vh] sm:rounded-2xl rounded-t-3xl border-t border-[--border] shadow-2xl flex flex-col">
            <div class="relative w-full h-56 bg-black shrink-0 overflow-hidden">
                <img id="modal-image" class="w-full h-full object-cover" src="">
                <video id="modal-video" class="w-full h-full object-cover hidden" loop muted playsinline autoplay></video>
                <div class="absolute inset-0 bg-gradient-to-t from-[#111] to-transparent"></div>
                <button onclick="closeModal()" class="absolute top-4 right-4 bg-black/50 text-white w-8 h-8 rounded-full flex items-center justify-center backdrop-blur-md z-10">‚úï</button>
            </div>
            <div class="p-6 flex-1 overflow-y-auto no-scrollbar">
                <h2 id="modal-title" class="text-xl font-black text-white uppercase brand-font mb-2"></h2>
                <span id="modal-tag" class="text-[9px] font-bold bg-[--accent-dim] text-[--accent] px-2 py-1 rounded uppercase border border-[--accent]/20 inline-block mb-3"></span>
                <p id="modal-desc" class="text-xs text-gray-400 mb-6 leading-relaxed whitespace-pre-line"></p>
                <div id="tiers-list" class="space-y-2"></div>
            </div>
        </div>
    </div>
</div>

<script>
    const CONFIG = { 
        ADMIN: "33757849093", 
        CURRENCY: "‚Ç¨", 
        MAINTENANCE: false 
    };

    let cart = [];
    let currentView = 'menu';

    const CATALOG = [
        {
            id: 'WZ-ALL', name: "Olives Wizard Treez - Frozen Sift üßäüßô‚Äç‚ôÄÔ∏è", category: 'Sunny Valley', icon: 'üßô‚Äç‚ôÄÔ∏è',
            desc: "üá∫üá∏ CALI CONNECTION EXCLUSIVE üá∫üá∏\n\nLE TERROIR WIZARD TREEZ D√âBARQUE !\n\n5 STRAINS L√âGENDAIRES R√âUNIES.\n\nüßä FROZEN SIFT PREMIUM", tag: "WIZARD TREEZ",
            image: "https://res.cloudinary.com/dlmmylat6/image/upload/v1765993841/IMG_2073_ffmyfd.jpg",
            tiers: [{w:'5G',p:80},{w:'10G',p:170}]
        },
        {
            id: 'PK', name: 'Pink Kush', category: 'Sunny Valley', icon: 'üß¨', 
            desc: "Import Cali üá∫üá∏. Taux THC 34%. La r√©f√©rence Top Shelf.", tag: "TOP SHELF",
            video: "https://res.cloudinary.com/dlmmylat6/video/upload/v1764906290/06AECEF5-7C0A-493C-9588-99433B454A4E_2_1_hnlzee.mov",
            tiers: [{w:'5G',p:60},{w:'10G',p:120},{w:'25G',p:220}]
        },
        {
            id: 'MC', name: 'MONTE CRISTO', category: 'Snow Valley', icon: 'üèîÔ∏è',
            desc: "Puret√© exceptionnelle (0.98%). Une exp√©rience unique.", tag: "DIAMOND",
            video: "https://res.cloudinary.com/dlmmylat6/video/upload/v1764906305/IMG_1629_ntkjra.mp4",
            tiers: [{w:'1G',p:60},{w:'2G',p:120},{w:'5G',p:260}]
        }
    ];

    window.onload = () => {
        const tg = window.Telegram?.WebApp;
        if (!tg || !tg.initData) {
            if(location.hostname !== 'localhost') {
                document.getElementById('intro-layer').style.display = 'none';
                document.getElementById('access-denied-screen').classList.remove('hidden');
                return;
            }
        }
        if(tg) tg.expand();
        checkStatus();
        updateTicker();

        setTimeout(() => {
            document.getElementById('intro-layer').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('intro-layer').style.display = 'none';
                document.getElementById('app-container').classList.remove('hidden');
                router('menu');
            }, 800);
        }, 2000);
    };

    function checkStatus() {
        const h = new Date().getHours();
        const isOpen = (h >= 10 || h < 3);
        const dot = document.getElementById('status-dot');
        const text = document.getElementById('status-text');
        dot.className = isOpen ? "w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse" : "w-1.5 h-1.5 rounded-full bg-red-500";
        text.innerText = isOpen ? "OP√âRATIONNEL" : "FERM√â";
    }

    async function updateTicker() {
        const el = document.getElementById('live-ticker');
        const msg = '<span class="ticker-item">‚ö° LIVRAISON 24/48H</span><span class="ticker-item">üîí PAIEMENT CRYPTO DISCRET</span>';
        el.innerHTML = msg.repeat(10);
    }

    function router(view) {
        currentView = view;
        const main = document.getElementById('main-view');
        document.querySelectorAll('nav button').forEach(b => b.classList.add('opacity-50'));
        document.getElementById(`nav-${view}`)?.classList.remove('opacity-50');

        main.innerHTML = '';
        if(view === 'menu') {
            main.innerHTML = `
                <div class="titanium-card p-6 fade-in mb-6">
                    <h2 class="brand-font text-xl font-black mb-2 italic text-[--accent]">SOUTH VALLEY QG</h2>
                    <p class="text-[10px] text-gray-500 uppercase tracking-widest">Op√©rations de nuit activ√©es</p>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div onclick="router('products')" class="titanium-card p-4 aspect-square flex flex-col items-center justify-center gap-3">
                        <span class="text-3xl">üåø</span>
                        <span class="text-[10px] font-black uppercase">Sunny Valley</span>
                    </div>
                    <div onclick="router('products')" class="titanium-card p-4 aspect-square flex flex-col items-center justify-center gap-3">
                        <span class="text-3xl">‚ùÑÔ∏è</span>
                        <span class="text-[10px] font-black uppercase">Snow Valley</span>
                    </div>
                </div>
            `;
        } else if(view === 'products') {
            CATALOG.forEach(p => {
                main.innerHTML += `
                    <div class="titanium-card overflow-hidden fade-in mb-4" onclick="openProduct('${p.id}')">
                        <div class="h-32 bg-black relative">
                            <img src="${p.image || ''}" class="w-full h-full object-cover opacity-60">
                            <div class="absolute inset-0 bg-gradient-to-t from-black to-transparent"></div>
                            <div class="absolute bottom-3 left-3">
                                <span class="text-[8px] font-bold bg-[--accent] text-black px-1.5 py-0.5 rounded uppercase mb-1 inline-block">${p.tag}</span>
                                <h3 class="font-black text-sm uppercase">${p.name}</h3>
                            </div>
                        </div>
                    </div>
                `;
            });
        } else if(view === 'cart') {
            renderCart(main);
        } else if(view === 'infos') {
             main.innerHTML = `
                <div class="titanium-card p-6 fade-in">
                    <h2 class="brand-font font-black mb-4">LOGISTIQUE</h2>
                    <ul class="text-xs text-gray-400 space-y-4">
                        <li class="flex items-start gap-3"><span>üì¶</span> Livraison sous pli discret sans mention externe.</li>
                        <li class="flex items-start gap-3"><span>üí≥</span> Crypto (LTC/BTC) prioritaires pour 0 traces.</li>
                    </ul>
                </div>
             `;
        }
    }

    function openProduct(id) {
        const p = CATALOG.find(x => x.id === id);
        const modal = document.getElementById('product-modal');
        const vid = document.getElementById('modal-video');
        const img = document.getElementById('modal-image');
        
        document.getElementById('modal-title').innerText = p.name;
        document.getElementById('modal-tag').innerText = p.tag;
        document.getElementById('modal-desc').innerText = p.desc;
        
        if(p.video) {
            vid.src = p.video;
            vid.classList.remove('hidden');
            img.classList.add('hidden');
        } else {
            img.src = p.image;
            img.classList.remove('hidden');
            vid.classList.add('hidden');
        }

        const list = document.getElementById('tiers-list');
        list.innerHTML = '';
        p.tiers.forEach(t => {
            list.innerHTML += `
                <div onclick="addToCart('${p.id}', '${t.w}', ${t.p})" class="bg-[#1a1a1a] border border-[#333] p-4 rounded-xl flex justify-between items-center active:bg-[#222]">
                    <span class="text-sm font-bold">${t.w}</span>
                    <span class="text-sm font-black text-[--accent]">${t.p}${CONFIG.CURRENCY}</span>
                </div>
            `;
        });

        modal.classList.remove('hidden');
    }

    function closeModal() {
        document.getElementById('product-modal').classList.add('hidden');
        document.getElementById('modal-video').pause();
    }

    function addToCart(id, weight, price) {
        const p = CATALOG.find(x => x.id === id);
        cart.push({ ...p, selectedWeight: weight, selectedPrice: price });
        document.getElementById('cart-dot').classList.remove('hidden');
        closeModal();
        if(window.Telegram?.WebApp?.HapticFeedback) window.Telegram.WebApp.HapticFeedback.notificationOccurred('success');
    }

    function renderCart(c) {
        if(cart.length === 0) {
            c.innerHTML = '<div class="text-center py-20 opacity-30 font-black uppercase text-xs">Panier Vide</div>';
            return;
        }
        let total = 0;
        let html = '<h2 class="brand-font font-black text-lg mb-4">MA COMMANDE</h2><div class="space-y-3">';
        cart.forEach((item, idx) => {
            total += item.selectedPrice;
            html += `
                <div class="titanium-card p-4 flex justify-between items-center">
                    <div>
                        <h4 class="text-xs font-bold uppercase">${item.name}</h4>
                        <p class="text-[10px] text-gray-500">${item.selectedWeight}</p>
                    </div>
                    <div class="flex items-center gap-4">
                        <span class="text-xs font-black">${item.selectedPrice}‚Ç¨</span>
                        <button onclick="removeFromCart(${idx})" class="text-red-500">‚úï</button>
                    </div>
                </div>
            `;
        });
        html += `</div><div class="mt-8 titanium-card p-6 border-t-2 border-[--accent]">
                    <div class="flex justify-between mb-6">
                        <span class="font-bold">TOTAL</span>
                        <span class="font-black text-xl text-[--accent]">${total}‚Ç¨</span>
                    </div>
                    <button onclick="sendOrder()" class="btn-main w-full py-4">VALIDER LA COMMANDE</button>
                </div>`;
        c.innerHTML = html;
    }

    function removeFromCart(idx) {
        cart.splice(idx, 1);
        if(cart.length === 0) document.getElementById('cart-dot').classList.add('hidden');
        renderCart(document.getElementById('main-view'));
    }

    function sendOrder() {
        let total = 0;
        let text = "üöÄ *NOUVELLE COMMANDE SOUTH VALLEY*\n\n";
        cart.forEach(item => {
            text += `‚ñ™Ô∏è ${item.name} (${item.selectedWeight}) : ${item.selectedPrice}‚Ç¨\n`;
            total += item.selectedPrice;
        });
        text += `\nüí∞ *TOTAL : ${total}‚Ç¨*`;
        
        const url = `https://wa.me/${CONFIG.ADMIN}?text=${encodeURIComponent(text)}`;
        window.open(url, '_blank');
    }
</script>
</body>
</html>
